import{o as a,c as s,a as e,w as F,v as L,b as _,d as P,u as U,r as A,e as v,f as p,g as k,t as m,h as f,i as j,j as w,F as q,k as M,l as N,n as z,m as I,p as $,q as G,s as C,x as R,y as H}from"./index-Kl6nar1x.js";import{h as E}from"./moment--5bDLNTH.js";import"./ar-sa-4OBkw8FF.js";import{d as T}from"./default-event-TthUPv4k.js";import{u as K}from"./useLiteraries-SAfAsjGb.js";const Q={class:"my-4 filters"},W={class:"scroller"},J=P('<option value="">كل الأوقات</option><option value="this_week">هذا الاسبوع</option><option value="next_week">الاسبوع القادم</option><option value="this_month">هذا الشهر</option><option value="next_month">الشهر القادم</option>',5),X=[J],Z=e("option",{value:""},"كل الفئات",-1),ee=e("option",{value:"1"},"الأطفال (0-11)",-1),te=e("option",{value:"2"},"اليافعين (12-18)",-1),ae=e("option",{value:"3"},"الكبار (+18)",-1),se=[Z,ee,te,ae],ne={key:0,class:"fa-solid fa-th-large expand"},oe={key:1,class:"fa-solid fa-list expand"},ie={__name:"FilterComponent",props:{state:{type:Object,required:!0},map:{type:Boolean,default:!1},literaries:{type:Array,default:()=>[]}},setup(t){return(r,d)=>(a(),s("div",Q,[e("div",W,[F(e("select",{class:"form-select mx-2","aria-label":"Default select example","onUpdate:modelValue":d[0]||(d[0]=u=>t.state.filter.date_range=u)},X,512),[[L,t.state.filter.date_range]]),F(e("select",{class:"form-select mx-2","aria-label":"Default select example","onUpdate:modelValue":d[1]||(d[1]=u=>t.state.filter.targeted_audience=u)},se,512),[[L,t.state.filter.targeted_audience]]),t.map?_("",!0):(a(),s("div",{key:0,onClick:d[2]||(d[2]=u=>t.state.view=t.state.view==="list"?"card":"list"),class:"expand d-block text-decoration-none"},[t.state.view==="list"?(a(),s("i",ne)):(a(),s("i",oe))]))])]))}},le={class:"event1"},re=["src"],ce={class:"dtails"},de={class:"title"},ue={key:0,class:"badge bg-brand text-light me-2"},ve=["innerHTML"],ge={class:"d-flex justify-content-between align-items-center mt-3"},me={class:"partner"},he=["src"],_e={class:"d-flex"},be={key:0,class:"date text-end"},fe={class:"ms-0"},ye=e("i",{class:"fa-regular fa-calendar-days ms-2"},null,-1),$e=e("br",null,null,-1),pe={class:"d-flex flex-row-reverse align-items-center"},xe=e("i",{class:"fa-regular fa-clock ms-2"},null,-1),ke={dir:"ltr"},qe={key:0,class:"d-flex align-items-center me-3"},Me=e("i",{class:"fa-solid fa-couch ms-2 text-danger"},null,-1),Ne={key:1,class:"d-flex align-items-center me-3"},we=e("i",{class:"fa-solid fa-couch ms-2 text-secondary"},null,-1),Ee=e("div",{class:"atendees"},[e("div",{class:"number"}),e("div",{class:"actions"})],-1),S={__name:"EventList",props:{event:{type:Object,required:!0}},setup(t){const{getUser:r}=U();return(d,u)=>{var o,c,n,h,i,b,l;const g=A("router-link");return a(),s("div",le,[e("img",{class:"img",src:t.event.image?t.event.image:v(T),alt:"image"},null,8,re),e("div",ce,[e("div",null,[e("div",de,[p(g,{to:{name:"event-details",params:{id:t.event.id}},class:"fw-semibold"},{default:k(()=>[f(m(t.event.title??"N/A")+" ",1),v(r)&&t.event.goings.includes(v(r).id)?(a(),s("span",ue," محجوز ")):_("",!0)]),_:1},8,["to"]),e("div",{class:"text-muted small mt-2",innerHTML:t.event.description},null,8,ve)])]),e("div",ge,[e("div",me,[e("img",{src:(c=(o=t.event)==null?void 0:o.partner)==null?void 0:c.logo,alt:"partner-logo"},null,8,he),e("div",_e,[f(m(((h=(n=t.event)==null?void 0:n.partner)==null?void 0:h.name)??"N/A")+" ",1),e("span",null,m(((b=(i=t.event)==null?void 0:i.partner)==null?void 0:b.city)??"N/A"),1)])]),(l=t.event)!=null&&l.start_date?(a(),s("div",be,[e("span",fe,m(v(E)(t.event.start_date).format("DD-MM-YYYY")),1),ye,$e,e("div",pe,[xe,e("span",ke,m(v(E)(t.event.start_date).format("hh:mm A")),1),t.event.guest_count>=t.event.available_seats?(a(),s("div",qe,[f(" إنتهت "),Me])):(a(),s("div",Ne,[f(m(t.event.available_seats-t.event.guest_count)+" ",1),we]))])])):_("",!0)]),Ee])])}}},Ae={class:"event2"},Ie={class:"title"},Ce={key:0,class:"badge bg-brand text-light me-2"},je=["src"],De={class:"dtails"},Oe={class:"d-flex justify-content-between align-items-center mt-3"},Be={class:"partner"},Fe=["src"],Le={class:"d-flex"},Pe={class:"date text-end"},Ue={class:"ms-0"},Re=e("i",{class:"fa-regular fa-calendar-days ms-2"},null,-1),Te=e("br",null,null,-1),Se={class:"d-flex flex-row-reverse align-items-center"},Ye=e("i",{class:"fa-regular fa-clock ms-2"},null,-1),Ve={dir:"ltr"},ze={key:0,class:"d-flex align-items-center me-3"},Ge=e("i",{class:"fa-solid fa-couch ms-2 text-secondary"},null,-1),He={key:1,class:"d-flex align-items-center me-3"},Ke=e("i",{class:"fa-solid fa-couch ms-2 text-danger"},null,-1),Qe=e("div",{class:"atendees"},[e("div",{class:"number"}),e("div",{class:"actions"})],-1),Y={__name:"EventCard",props:{event:{type:Object,required:!0}},setup(t){const{getUser:r}=U();return(d,u)=>{var o,c,n,h,i,b;const g=A("router-link");return a(),s("div",Ae,[e("div",Ie,[p(g,{to:{name:"event-details",params:{id:t.event.id}},class:"fw-semibold"},{default:k(()=>[f(m(t.event.title??"N/A")+" ",1),t.event.goings.includes(v(r).id)?(a(),s("span",Ce," محجوز ")):_("",!0)]),_:1},8,["to"])]),p(g,{to:{name:"event-details",params:{id:t.event.id}}},{default:k(()=>[e("img",{class:"img",src:t.event.image?t.event.image:v(T)},null,8,je)]),_:1},8,["to"]),e("div",De,[e("div",Oe,[e("div",Be,[e("img",{src:(c=(o=t.event)==null?void 0:o.partner)==null?void 0:c.logo,alt:"partner logo"},null,8,Fe),e("div",Le,[f(m(((h=(n=t.event)==null?void 0:n.partner)==null?void 0:h.name)??"N/A")+" ",1),e("span",null,m(((b=(i=t.event)==null?void 0:i.partner)==null?void 0:b.city)??"N/A"),1)])]),e("div",Pe,[e("span",Ue,m(v(E)(t.event.start_date).format("DD-MM-YYYY")),1),Re,Te,e("div",Se,[Ye,e("span",Ve,m(v(E)(t.event.start_date).format("hh:mm A")),1),t.event.guest_count<=t.event.available_seats?(a(),s("div",ze,[f(m(t.event.available_seats-t.event.guest_count)+" ",1),Ge])):(a(),s("div",He,[f(" إنتهت "),Ke]))])])]),Qe])])}}},We={class:"tab-pane fade show active",id:"home-tab-pane",role:"tabpanel","aria-labelledby":"home-tab",tabindex:"0"},Je={class:"my-4 d-flex justify-content-between align-items-center"},Xe=e("i",{class:"fa-solid fa-location-dot"},null,-1),Ze={key:0,class:"text-center my-4"},et=e("div",{class:"spinner-border",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),tt=[et],at={key:3,class:"alert alert-info text-center"},st={key:4,class:"text-center mt-4"},nt=["disabled"],ot={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},it={role:"status"},lt={__name:"Upcoming",props:{events:{type:Array,required:!0},loading:{type:Boolean,required:!0},loadingMore:{type:Boolean,required:!0},state:{type:Object,required:!0}},setup(t){const r=j(),d=w(),{data:u}=K("upcoming"),g=()=>{const o=d.query.pageN??1;r.push({query:{...d.query,pageN:Number(o)+1}})};return(o,c)=>{var h;const n=A("router-link");return a(),s("div",We,[e("h2",Je,[f(" فعاليات قريبة منك "),p(n,{to:{name:"event-map"},class:"btn btn-light"},{default:k(()=>[Xe,f(" عرض الخريطة")]),_:1})]),p(ie,{state:t.state,literaries:(h=v(u))==null?void 0:h.data},null,8,["state","literaries"]),t.loading?(a(),s("div",Ze,tt)):_("",!0),t.state.view==="list"&&!t.loading?(a(!0),s(q,{key:1},M(t.events,i=>(a(),N(S,{key:i.id,event:i},null,8,["event"]))),128)):t.state.view==="card"&&!t.loading?(a(!0),s(q,{key:2},M(t.events,(i,b)=>(a(),N(Y,{key:i.index,event:i},null,8,["event"]))),128)):_("",!0),!t.loading&&!t.events.length?(a(),s("div",at," لا يوجد فعاليات متاحة حالياً ")):_("",!0),t.state.meta.total>t.events.length?(a(),s("div",st,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:c[0]||(c[0]=i=>g()),disabled:t.loadingMore||t.loading},[t.loadingMore?(a(),s("span",ot)):_("",!0),e("span",it,m(t.loadingMore?"جاري التحميل":"عرض المزيد"),1)],8,nt)])):_("",!0)])}}},rt={class:"tab-pane fade",id:"profile-tab-pane",role:"tabpanel","aria-labelledby":"profile-tab",tabindex:"0"},ct=e("h2",{class:"my-4 d-flex justify-content-between align-items-center"},[f(" فعاليات قريبة منك "),e("a",{href:"/events/map",class:"btn btn-light"},[e("i",{class:"fa-solid fa-location-dot"}),f(" عرض الخريطة")])],-1),dt={key:0,class:"text-center my-4"},ut=e("div",{class:"spinner-border",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),vt=[ut],gt={key:3,class:"alert alert-info text-center"},mt={class:"text-center mt-4"},ht=["disabled"],_t={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},bt={role:"status"},ft={__name:"Past",props:{events:{type:Array,required:!0},loading:{type:Boolean,required:!0},loadingMore:{type:Boolean,required:!0},state:{type:Object,required:!0}},setup(t){const r=j(),d=w(),u=()=>{const g=d.query.pageP??1;r.push({query:{...d.query,pageP:Number(g)+1}})};return(g,o)=>(a(),s("div",rt,[ct,t.loading?(a(),s("div",dt,vt)):_("",!0),t.state.view==="list"&&!t.loading?(a(!0),s(q,{key:1},M(t.events,c=>(a(),N(S,{key:c.id,event:c},null,8,["event"]))),128)):t.state.view==="card"&&!t.loading?(a(!0),s(q,{key:2},M(t.events,(c,n)=>(a(),N(Y,{key:c.index,event:c},null,8,["event"]))),128)):_("",!0),!t.loading&&!t.events.length?(a(),s("div",gt," لا يوجد فعاليات متاحة حالياً ")):_("",!0),e("div",mt,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:o[0]||(o[0]=c=>u()),disabled:t.loadingMore||t.loading},[t.loadingMore?(a(),s("span",_t)):_("",!0),e("span",bt,m(t.loadingMore?"جاري التحميل":"عرض المزيد"),1)],8,ht)])]))}},yt="/i/assets/event-08-rsnpQB_z.png",$t="/i/assets/event-09-pgwkdRdF.png",pt={id:"carouselExampleIndicators",class:"carousel slide","data-bs-ride":"carousel"},xt=e("div",{class:"carousel-indicators"},[e("button",{type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide-to":"0",class:"active","aria-current":"true","aria-label":""}),e("button",{type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide-to":"1","aria-label":""}),e("button",{type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide-to":"2","aria-label":""})],-1),kt={class:"carousel-inner"},qt=["data-bs-interval"],Mt=e("div",{class:"d-none text-white bg-dark px-3 py-2 position-absolute top-0 start-0 m-2 rounded shadow text-center"},null,-1),Nt={key:1},wt={class:"carousel-item active text-center","data-bs-interval":"100000"},Et={class:"carousel-item"},At=P('<button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="visually-hidden">السابق</span></button><button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="visually-hidden">التالي</span></button>',2),It={__name:"Carousel",props:{events:{type:Object,required:!0}},setup(t){const r=t;return(d,u)=>{const g=A("router-link");return a(),s("div",pt,[xt,e("div",kt,[r.events.length?(a(!0),s(q,{key:0},M(r.events,o=>(a(),s("div",{key:o.id,class:z(["carousel-item",{active:o.id===r.events[0].id}]),"data-bs-interval":o.id===r.events[0].id?"10000":"2000"},[p(g,{to:{name:"event-details",params:{id:o.id}}},{default:k(()=>[e("a",{class:"img",style:I({"background-image":`url(${o.image})`})},null,4)]),_:2},1032,["to"]),Mt],10,qt))),128)):(a(),s("div",Nt,[e("div",wt,[e("div",{class:"img",style:I({"background-image":`url(${v(yt)})`})},null,4)]),e("div",Et,[e("div",{class:"img",style:I({"background-image":`url(${v($t)})`})},null,4)])]))]),At])}}},Ct=t=>{const r=w(),d=j(),u=$([]),g=$([]),o=$(!1),c=$(!1),n=G({carousel:[],view:"list",search:"أدبيات",filter:{date_range:r.query.date||"",type:r.query.type||"",targeted_audience:r.query.targeted_audience||""},location:{lat:24.774265,lng:46.738586},meta:{}});C(()=>r.query.pageN,i=>{h(i)});const h=async(i,b=!0)=>{let l="";n.filter.date_range&&(l+="&date_range="+n.filter.date_range),n.filter.type&&(l+="&type="+n.filter.type),n.filter.targeted_audience&&(l+="&targeted_audience="+n.filter.targeted_audience),n.location&&(l+="&lat="+n.location.lat+"&lng="+n.location.lng);const{data:x,error:D,isFetching:O,onFetchResponse:y}=R("events/upcoming?page="+i+l).json();u.value.length===0?o.value=!0:c.value=!0,y(B=>{B.status===200&&(o.value=!1,c.value=!1,b?u.value=[...u.value,...x.value.data]:u.value=x.value.data,n.meta=x.value.meta,g.value=u.value.filter((V,Tt)=>!V.default_image).slice(0,3))})};return C(()=>n.filter,async(i,b)=>{let l={};i.date_range&&(l.date=i.date_range),i.type&&(l.type=i.type),i.targeted_audience&&(l.targeted_audience=i.targeted_audience),l.pageN=1,await d.push({query:{...r.query,...l}}),await h(t.value,!1)},{deep:!0}),h(t.value),{events:u,loading:o,loadingMore:c,carousel:g,state:n}},jt=t=>{const r=w(),d=$([]),u=$(!1),g=$(!1);C(()=>r.query.pageP,c=>{o(c)});const o=async c=>{const{data:n,error:h,isFetching:i,onFetchResponse:b}=R("events/past?page="+c).json();d.value.length===0?u.value=!0:g.value=!0,b(l=>{l.status===200&&(u.value=!1,g.value=!1,d.value=[...d.value,...n.value.data])})};return o(t.value),{events:d,loading:u,loadingMore:g}},Dt={class:"home"},Ot={class:"container wrapper mt-3"},Bt={class:"nav nav-tabs mt-4",id:"myTab",role:"tablist"},Ft={class:"nav-item",role:"presentation"},Lt={class:"nav-link active",id:"home-tab","data-bs-toggle":"tab","data-bs-target":"#home-tab-pane",type:"button",role:"tab","aria-controls":"home-tab-pane","aria-selected":"true"},Pt={class:"nav-item",role:"presentation"},Ut={class:"nav-link",id:"profile-tab","data-bs-toggle":"tab","data-bs-target":"#profile-tab-pane",type:"button",role:"tab","aria-controls":"profile-tab-pane","aria-selected":"false"},Rt={class:"tab-content py-4",id:"myTabContent"},Ht={__name:"Events",setup(t){const r=w(),d=$(Number(r.query.pageN)||1),u=$(Number(r.query.pageP)||1),g=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(o,c,{enableHighAccuracy:!0}):data.error="Geolocation is not supported by browser."},o=async y=>{l.location={lat:y.coords.latitude,lng:y.coords.longitude},(l.location.lat<15||l.location.lat>35||l.location.lng<34||l.location.lng>56)&&(l.is_sa=!1,l.location={lat:24.7136,lng:46.6753})},c=y=>{switch(y.code){case y.PERMISSION_DENIED:data.error="User denied the request for Geolocation.";break;case y.POSITION_UNAVAILABLE:data.error="Location information is unavailable.";break;case y.TIMEOUT:data.error="The request to get user location timed out.";break;case y.UNKNOWN_ERROR:data.error="An unknown error occurred.";break}},{events:n,loading:h,loadingMore:i,carousel:b,state:l}=Ct(d),{events:x,loading:D,loadingMore:O}=jt(u);return H(async()=>{await g()}),(y,B)=>(a(),s("div",null,[e("div",Dt,[e("div",Ot,[v(n).length?(a(),N(It,{key:0,events:v(b)},null,8,["events"])):_("",!0),e("ul",Bt,[e("li",Ft,[e("button",Lt," الفعاليات القادمة ("+m(v(n).length)+") ",1)]),e("li",Pt,[e("button",Ut," الفعاليات المنتهية ("+m(v(x).length)+") ",1)])]),e("div",Rt,[p(lt,{events:v(n),loading:v(h),state:v(l),loadingMore:v(i)},null,8,["events","loading","state","loadingMore"]),p(ft,{events:v(x),loading:v(D),state:v(l),loadingMore:v(O)},null,8,["events","loading","state","loadingMore"])])])])]))}};export{Ht as default};
