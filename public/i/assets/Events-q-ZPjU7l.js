import{o as a,c as n,a as t,w as F,v as L,b,d as P,u as U,r as I,e as v,f as p,g as k,t as h,h as f,i as j,j as w,F as q,k as M,l as N,n as G,m as C,p as $,q as H,s as E,x as R,y as V}from"./index-ds_cStk2.js";import{h as A}from"./moment-12uMA0Xz.js";import"./ar-sa-7EEEo9Kh.js";import{d as T}from"./default-event-TthUPv4k.js";import{u as K}from"./useLiteraries-HV2pHX77.js";const Q={class:"my-4 filters"},W={class:"scroller"},J=P('<option value="">كل الأوقات</option><option value="this_week">هذا الاسبوع</option><option value="next_week">الاسبوع القادم</option><option value="this_month">هذا الشهر</option><option value="next_month">الشهر القادم</option>',5),X=[J],Z=t("option",{value:""},"كل الفئات",-1),ee=t("option",{value:"1"},"الأطفال (0-11)",-1),te=t("option",{value:"2"},"اليافعين (12-18)",-1),ae=t("option",{value:"3"},"الكبار (+18)",-1),se=[Z,ee,te,ae],ne={key:0,class:"fa-solid fa-th-large expand"},oe={key:1,class:"fa-solid fa-list expand"},ie={__name:"FilterComponent",props:{state:{type:Object,required:!0},map:{type:Boolean,default:!1},literaries:{type:Array,default:()=>[]}},setup(e){return(l,c)=>(a(),n("div",Q,[t("div",W,[F(t("select",{class:"form-select mx-2","aria-label":"Default select example","onUpdate:modelValue":c[0]||(c[0]=u=>e.state.filter.date_range=u)},X,512),[[L,e.state.filter.date_range]]),F(t("select",{class:"form-select mx-2","aria-label":"Default select example","onUpdate:modelValue":c[1]||(c[1]=u=>e.state.filter.targeted_audience=u)},se,512),[[L,e.state.filter.targeted_audience]]),e.map?b("",!0):(a(),n("div",{key:0,onClick:c[2]||(c[2]=u=>e.state.view=e.state.view==="list"?"card":"list"),class:"expand d-block text-decoration-none"},[e.state.view==="list"?(a(),n("i",ne)):(a(),n("i",oe))]))])]))}},le={class:"event1"},re=["src"],ce={class:"dtails"},de={class:"title"},ue={key:0,class:"badge bg-brand text-light me-2"},ve=["innerHTML"],ge={class:"d-flex justify-content-between align-items-center mt-3"},me={class:"partner"},he=["src"],_e={class:"d-flex"},be={key:0,class:"date text-end"},fe={class:"ms-0"},ye=t("i",{class:"fa-regular fa-calendar-days ms-2"},null,-1),$e=t("br",null,null,-1),pe={class:"d-flex flex-row-reverse align-items-center"},xe=t("i",{class:"fa-regular fa-clock ms-2"},null,-1),ke={dir:"ltr"},qe={key:0,class:"d-flex align-items-center me-3"},Me=t("i",{class:"fa-solid fa-couch ms-2 text-danger"},null,-1),Ne={key:1,class:"d-flex align-items-center me-3"},we=t("i",{class:"fa-solid fa-couch ms-2 text-secondary"},null,-1),Ee=t("div",{class:"atendees"},[t("div",{class:"number"}),t("div",{class:"actions"})],-1),S={__name:"EventList",props:{event:{type:Object,required:!0}},setup(e){const{getUser:l}=U();return(c,u)=>{var r,d,i,m,o,_,s;const g=I("router-link");return a(),n("div",le,[t("img",{class:"img",src:e.event.image?e.event.image:v(T),alt:"image"},null,8,re),t("div",ce,[t("div",null,[t("div",de,[p(g,{to:{name:"event-details",params:{id:e.event.id}},class:"fw-semibold"},{default:k(()=>[f(h(e.event.title??"N/A")+" ",1),v(l)&&e.event.goings.includes(v(l).id)?(a(),n("span",ue," محجوز ")):b("",!0)]),_:1},8,["to"]),t("div",{class:"text-muted small mt-2",innerHTML:e.event.description},null,8,ve)])]),t("div",ge,[t("div",me,[t("img",{src:(d=(r=e.event)==null?void 0:r.partner)==null?void 0:d.logo,alt:"partner-logo"},null,8,he),t("div",_e,[f(h(((m=(i=e.event)==null?void 0:i.partner)==null?void 0:m.name)??"N/A")+" ",1),t("span",null,h(((_=(o=e.event)==null?void 0:o.partner)==null?void 0:_.city)??"N/A"),1)])]),(s=e.event)!=null&&s.start_date?(a(),n("div",be,[t("span",fe,h(v(A)(e.event.start_date).format("DD-MM-YYYY")),1),ye,$e,t("div",pe,[xe,t("span",ke,h(v(A)(e.event.start_date).format("hh:mm A")),1),e.event.guest_count>=e.event.available_seats?(a(),n("div",qe,[f(" إنتهت "),Me])):(a(),n("div",Ne,[f(h(e.event.available_seats-e.event.guest_count)+" ",1),we]))])])):b("",!0)]),Ee])])}}},Ae={class:"event2"},Ie={class:"title"},Ce={key:0,class:"badge bg-brand text-light me-2"},je=["src"],De={class:"dtails"},Oe={class:"d-flex justify-content-between align-items-center mt-3"},Be={class:"partner"},Fe=["src"],Le={class:"d-flex"},Pe={class:"date text-end"},Ue={class:"ms-0"},Re=t("i",{class:"fa-regular fa-calendar-days ms-2"},null,-1),Te=t("br",null,null,-1),Se={class:"d-flex flex-row-reverse align-items-center"},Ye=t("i",{class:"fa-regular fa-clock ms-2"},null,-1),ze={dir:"ltr"},Ge={key:0,class:"d-flex align-items-center me-3"},He=t("i",{class:"fa-solid fa-couch ms-2 text-secondary"},null,-1),Ve={key:1,class:"d-flex align-items-center me-3"},Ke=t("i",{class:"fa-solid fa-couch ms-2 text-danger"},null,-1),Qe=t("div",{class:"atendees"},[t("div",{class:"number"}),t("div",{class:"actions"})],-1),Y={__name:"EventCard",props:{event:{type:Object,required:!0}},setup(e){const{getUser:l}=U();return(c,u)=>{var r,d,i,m,o,_;const g=I("router-link");return a(),n("div",Ae,[t("div",Ie,[p(g,{to:{name:"event-details",params:{id:e.event.id}},class:"fw-semibold"},{default:k(()=>[f(h(e.event.title??"N/A")+" ",1),e.event.goings.includes(v(l).id)?(a(),n("span",Ce," محجوز ")):b("",!0)]),_:1},8,["to"])]),p(g,{to:{name:"event-details",params:{id:e.event.id}}},{default:k(()=>[t("img",{class:"img",src:e.event.image?e.event.image:v(T)},null,8,je)]),_:1},8,["to"]),t("div",De,[t("div",Oe,[t("div",Be,[t("img",{src:(d=(r=e.event)==null?void 0:r.partner)==null?void 0:d.logo,alt:"partner logo"},null,8,Fe),t("div",Le,[f(h(((m=(i=e.event)==null?void 0:i.partner)==null?void 0:m.name)??"N/A")+" ",1),t("span",null,h(((_=(o=e.event)==null?void 0:o.partner)==null?void 0:_.city)??"N/A"),1)])]),t("div",Pe,[t("span",Ue,h(v(A)(e.event.start_date).format("DD-MM-YYYY")),1),Re,Te,t("div",Se,[Ye,t("span",ze,h(v(A)(e.event.start_date).format("hh:mm A")),1),e.event.guest_count<=e.event.available_seats?(a(),n("div",Ge,[f(h(e.event.available_seats-e.event.guest_count)+" ",1),He])):(a(),n("div",Ve,[f(" إنتهت "),Ke]))])])]),Qe])])}}},We={class:"tab-pane fade show active",id:"home-tab-pane",role:"tabpanel","aria-labelledby":"home-tab",tabindex:"0"},Je={class:"my-4 d-flex justify-content-between align-items-center"},Xe=t("i",{class:"fa-solid fa-location-dot"},null,-1),Ze={key:0,class:"text-center my-4"},et=t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),tt=[et],at={key:3,class:"alert alert-info text-center"},st={key:4,class:"text-center mt-4"},nt=["disabled"],ot={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},it={role:"status"},lt={__name:"Upcoming",props:{events:{type:Array,required:!0},loading:{type:Boolean,required:!0},loadingMore:{type:Boolean,required:!0},state:{type:Object,required:!0}},setup(e){const l=j(),c=w(),{data:u}=K("upcoming"),g=()=>{const r=c.query.pageN??1;l.push({query:{...c.query,pageN:Number(r)+1}})};return(r,d)=>{var m;const i=I("router-link");return a(),n("div",We,[t("h2",Je,[f(" فعاليات قريبة منك "),p(i,{to:{name:"event-map"},class:"btn btn-light"},{default:k(()=>[Xe,f(" عرض الخريطة")]),_:1})]),p(ie,{state:e.state,literaries:(m=v(u))==null?void 0:m.data},null,8,["state","literaries"]),e.loading?(a(),n("div",Ze,tt)):b("",!0),e.state.view==="list"&&!e.loading?(a(!0),n(q,{key:1},M(e.events,o=>(a(),N(S,{key:o.id,event:o},null,8,["event"]))),128)):e.state.view==="card"&&!e.loading?(a(!0),n(q,{key:2},M(e.events,(o,_)=>(a(),N(Y,{key:o.index,event:o},null,8,["event"]))),128)):b("",!0),!e.loading&&!e.events.length?(a(),n("div",at," لا يوجد فعاليات متاحة حالياً ")):b("",!0),e.state.meta.total>e.events.length?(a(),n("div",st,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:d[0]||(d[0]=o=>g()),disabled:e.loadingMore||e.loading},[e.loadingMore?(a(),n("span",ot)):b("",!0),t("span",it,h(e.loadingMore?"جاري التحميل":"عرض المزيد"),1)],8,nt)])):b("",!0)])}}},rt={class:"tab-pane fade",id:"profile-tab-pane",role:"tabpanel","aria-labelledby":"profile-tab",tabindex:"0"},ct=t("h2",{class:"my-4 d-flex justify-content-between align-items-center"},[f(" فعاليات قريبة منك "),t("a",{href:"/events/map",class:"btn btn-light"},[t("i",{class:"fa-solid fa-location-dot"}),f(" عرض الخريطة")])],-1),dt={key:0,class:"text-center my-4"},ut=t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),vt=[ut],gt={key:3,class:"alert alert-info text-center"},mt={class:"text-center mt-4"},ht=["disabled"],_t={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},bt={role:"status"},ft={__name:"Past",props:{events:{type:Array,required:!0},loading:{type:Boolean,required:!0},loadingMore:{type:Boolean,required:!0},state:{type:Object,required:!0}},setup(e){const l=j(),c=w(),u=()=>{const g=c.query.pageP??1;l.push({query:{...c.query,pageP:Number(g)+1}})};return(g,r)=>(a(),n("div",rt,[ct,e.loading?(a(),n("div",dt,vt)):b("",!0),e.state.view==="list"&&!e.loading?(a(!0),n(q,{key:1},M(e.events,d=>(a(),N(S,{key:d.id,event:d},null,8,["event"]))),128)):e.state.view==="card"&&!e.loading?(a(!0),n(q,{key:2},M(e.events,(d,i)=>(a(),N(Y,{key:d.index,event:d},null,8,["event"]))),128)):b("",!0),!e.loading&&!e.events.length?(a(),n("div",gt," لا يوجد فعاليات متاحة حالياً ")):b("",!0),t("div",mt,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:r[0]||(r[0]=d=>u()),disabled:e.loadingMore||e.loading},[e.loadingMore?(a(),n("span",_t)):b("",!0),t("span",bt,h(e.loadingMore?"جاري التحميل":"عرض المزيد"),1)],8,ht)])]))}},yt="/i/assets/event-08-rsnpQB_z.png",$t="/i/assets/event-09-pgwkdRdF.png",pt={id:"carouselExampleIndicators",class:"carousel slide","data-bs-ride":"carousel"},xt=t("div",{class:"carousel-indicators"},[t("button",{type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide-to":"0",class:"active","aria-current":"true","aria-label":""}),t("button",{type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide-to":"1","aria-label":""}),t("button",{type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide-to":"2","aria-label":""})],-1),kt={class:"carousel-inner"},qt=["data-bs-interval"],Mt=t("div",{class:"d-none text-white bg-dark px-3 py-2 position-absolute top-0 start-0 m-2 rounded shadow text-center"},null,-1),Nt={key:1},wt={class:"carousel-item active text-center","data-bs-interval":"100000"},Et={class:"carousel-item"},At=P('<button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="visually-hidden">السابق</span></button><button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="visually-hidden">التالي</span></button>',2),It={__name:"Carousel",props:{events:{type:Object,required:!0}},setup(e){const l=e;return(c,u)=>{const g=I("router-link");return a(),n("div",pt,[xt,t("div",kt,[l.events.length?(a(!0),n(q,{key:0},M(l.events,r=>(a(),n("div",{key:r.id,class:G(["carousel-item",{active:r.id===l.events[0].id}]),"data-bs-interval":r.id===l.events[0].id?"10000":"2000"},[p(g,{to:{name:"event-details",params:{id:r.id}}},{default:k(()=>[t("a",{class:"img",style:C({"background-image":`url(${r.image})`})},null,4)]),_:2},1032,["to"]),Mt],10,qt))),128)):(a(),n("div",Nt,[t("div",wt,[t("div",{class:"img",style:C({"background-image":`url(${v(yt)})`})},null,4)]),t("div",Et,[t("div",{class:"img",style:C({"background-image":`url(${v($t)})`})},null,4)])]))]),At])}}},Ct=e=>{const l=w(),c=j(),u=$([]),g=$([]),r=$(!1),d=$(!1),i=H({carousel:[],view:"list",search:"أدبيات",filter:{date_range:l.query.date||"",type:l.query.type||"",targeted_audience:l.query.targeted_audience||""},location:{lat:24.774265,lng:46.738586},meta:{}});E(()=>l.query.pageN,o=>{m(o)});const m=async(o,_=!0)=>{let s="";i.filter.date_range&&(s+="&date_range="+i.filter.date_range),i.filter.type&&(s+="&type="+i.filter.type),i.filter.targeted_audience&&(s+="&targeted_audience="+i.filter.targeted_audience),i.location&&(s+="&lat="+i.location.lat+"&lng="+i.location.lng);const{data:x,error:D,isFetching:O,onFetchResponse:y}=R("events/upcoming?page="+o+s).json();u.value.length===0?r.value=!0:d.value=!0,y(B=>{B.status===200&&(r.value=!1,d.value=!1,_?u.value=[...u.value,...x.value.data]:u.value=x.value.data,i.meta=x.value.meta,g.value=u.value.filter((z,Tt)=>!z.default_image).slice(0,3))})};return E(()=>i.filter,async(o,_)=>{let s={};o.date_range&&(s.date=o.date_range),o.type&&(s.type=o.type),o.targeted_audience&&(s.targeted_audience=o.targeted_audience),s.pageN=1,await c.push({query:{...l.query,...s}}),await m(e.value,!1)},{deep:!0}),E(()=>i.location,async(o,_)=>{let s={};o&&(s.lat=o.lat,s.lng=o.lng),s.pageN=1,await c.push({query:{...l.query,...s}}),await m(e.value,!1)},{deep:!0}),m(e.value),{events:u,loading:r,loadingMore:d,carousel:g,state:i}},jt=e=>{const l=w(),c=$([]),u=$(!1),g=$(!1);E(()=>l.query.pageP,d=>{r(d)});const r=async d=>{const{data:i,error:m,isFetching:o,onFetchResponse:_}=R("events/past?page="+d).json();c.value.length===0?u.value=!0:g.value=!0,_(s=>{s.status===200&&(u.value=!1,g.value=!1,c.value=[...c.value,...i.value.data])})};return r(e.value),{events:c,loading:u,loadingMore:g}},Dt={class:"home"},Ot={class:"container wrapper mt-3"},Bt={class:"nav nav-tabs mt-4",id:"myTab",role:"tablist"},Ft={class:"nav-item",role:"presentation"},Lt={class:"nav-link active",id:"home-tab","data-bs-toggle":"tab","data-bs-target":"#home-tab-pane",type:"button",role:"tab","aria-controls":"home-tab-pane","aria-selected":"true"},Pt={class:"nav-item",role:"presentation"},Ut={class:"nav-link",id:"profile-tab","data-bs-toggle":"tab","data-bs-target":"#profile-tab-pane",type:"button",role:"tab","aria-controls":"profile-tab-pane","aria-selected":"false"},Rt={class:"tab-content py-4",id:"myTabContent"},Vt={__name:"Events",setup(e){const l=w(),c=$(Number(l.query.pageN)||1),u=$(Number(l.query.pageP)||1),g=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(r,d,{enableHighAccuracy:!0}):data.error="Geolocation is not supported by browser."},r=async y=>{s.location={lat:y.coords.latitude,lng:y.coords.longitude},(s.location.lat<15||s.location.lat>35||s.location.lng<34||s.location.lng>56)&&(s.is_sa=!1,s.location={lat:24.7136,lng:46.6753})},d=y=>{switch(y.code){case y.PERMISSION_DENIED:data.error="User denied the request for Geolocation.";break;case y.POSITION_UNAVAILABLE:data.error="Location information is unavailable.";break;case y.TIMEOUT:data.error="The request to get user location timed out.";break;case y.UNKNOWN_ERROR:data.error="An unknown error occurred.";break}},{events:i,loading:m,loadingMore:o,carousel:_,state:s}=Ct(c),{events:x,loading:D,loadingMore:O}=jt(u);return V(async()=>{await g()}),(y,B)=>(a(),n("div",null,[t("div",Dt,[t("div",Ot,[v(i).length?(a(),N(It,{key:0,events:v(_)},null,8,["events"])):b("",!0),t("ul",Bt,[t("li",Ft,[t("button",Lt," الفعاليات القادمة ("+h(v(i).length)+") ",1)]),t("li",Pt,[t("button",Ut," الفعاليات المنتهية ("+h(v(x).length)+") ",1)])]),t("div",Rt,[p(lt,{events:v(i),loading:v(m),state:v(s),loadingMore:v(o)},null,8,["events","loading","state","loadingMore"]),p(ft,{events:v(x),loading:v(D),state:v(s),loadingMore:v(O)},null,8,["events","loading","state","loadingMore"])])])])]))}};export{Vt as default};
